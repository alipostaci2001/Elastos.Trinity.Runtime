{"version":3,"sources":["../../src/pages/supernodeelection/superpoint/updateproducer/updateproducer.module.ts","../../src/pages/supernodeelection/superpoint/updateproducer/updateproducer.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { UpdateproducerPage } from './updateproducer';\n\n@NgModule({\n  declarations: [\n    UpdateproducerPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UpdateproducerPage),\n    TranslateModule.forChild()\n  ],\n})\nexport class UpdateproducerPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/supernodeelection/superpoint/updateproducer/updateproducer.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport {Native} from \"../../../../providers/Native\";\nimport {PopupProvider} from \"../../../../providers/popup\";\nimport {Util} from '../../../../providers/Util';\nimport {  Config } from '../../../../providers/Config';\nimport {WalletManager} from '../../../../providers/WalletManager';\nimport {ScancodePage} from '../../../../pages/scancode/scancode';\n\n/**\n * Generated class for the UpdateproducerPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-updateproducer',\n  templateUrl: 'updateproducer.html',\n})\nexport class UpdateproducerPage {\n  info ={};\n  public passworld:string = \"\";\n  public masterId:string = \"\";\n  public curChain = \"ELA\";\n  public fee:number = 0;\n  public feePerKb:number = 10000;\n  public walletInfo = {};\n  public deposit;\n  public countrys = [];\n  constructor(public navCtrl: NavController, public navParams: NavParams,public native :Native,public popupProvider: PopupProvider,public walletManager:WalletManager) {\n          this.countrys = Config.getAllCountry();\n          this.info = this.native.clone(this.navParams.data);\n          this.masterId = Config.getCurMasterWalletId();\n          this.init();\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad UpdateproducerPage');\n  }\n\n  init(){\n    this.walletManager.getMasterWalletBasicInfo(this.masterId,(data)=>{\n                 if(data[\"success\"]){\n                    this.native.info(data);\n                    let item = JSON.parse(data[\"success\"])[\"Account\"];\n                    this.walletInfo = item;\n                 }\n    });\n  }\n\n  updateInfo(){\n    if(this.checkParms()){\n      this.popupProvider.presentPrompt().then((val)=>{\n        if(Util.isNull(val)){\n          this.native.toast_trans(\"text-id-kyc-prompt-password\");\n          return;\n        }\n        this.passworld = val.toString();\n        this.native.showLoading().then(()=>{\n              this.generateProducerPayload();\n        });\n        //this.native.Go(this.navCtrl,'JoinvotelistPage');\n  }).catch(()=>{\n\n  });\n    }\n\n  }\n\n\n  generateProducerPayload(){\n    this.walletManager.generateProducerPayload(this.masterId,this.curChain,this.info[\"ownerpublickey\"],this.info[\"nodepublickey\"],this.info[\"nickname\"],this.info[\"url\"],this.info[\"netaddress\"],this.info[\"location\"],this.passworld,(data)=>{\n     this.native.info(data);\n     if(data[\"success\"]){\n        let payLoad = data[\"success\"];\n        this.createUpdateProducerTransaction(payLoad);\n     }\n   });\n }\n\n\n\n\n createUpdateProducerTransaction(payloadJson){\n\n  this.walletManager.createUpdateProducerTransaction(this.masterId,this.curChain,\"\",payloadJson,\"\",\"\",false,(data)=>{\n    this.native.info(data);\n    if(data[\"success\"]){\n      this.getFee(data[\"success\"]);\n    }\n  });\n}\n\n //计算手续费\n getFee(rawTransaction){\n  this.walletManager.calculateTransactionFee(this.masterId,this.curChain,rawTransaction, this.feePerKb, (data) => {\n    if(data['success']){\n      this.native.hideLoading();\n      this.native.info(data);\n      this.fee = data['success'];\n      this.popupProvider.presentConfirm1(this.fee/Config.SELA).then(()=>{\n              this.native.showLoading().then(()=>{\n                this.updateTxFee(rawTransaction);\n              });\n\n      });\n    }\n  });\n }\n\n\n updateTxFee(rawTransaction){\n\n  this.walletManager.updateTransactionFee(this.masterId,this.curChain,rawTransaction, this.fee,\"\",(data)=>{\n    if(data[\"success\"]){\n     this.native.info(data);\n     if(this.walletInfo[\"Type\"] === \"Multi-Sign\" && this.walletInfo[\"InnerType\"] === \"Readonly\"){\n              this.readWallet(data[\"success\"]);\n              return;\n     }\n     this.singTx(data[\"success\"]);\n    }else{\n     this.native.info(data);\n    }\n});\n }\n\n\n singTx(rawTransaction){\n  this.walletManager.signTransaction(this.masterId,this.curChain,rawTransaction,this.passworld,(data)=>{\n    if(data[\"success\"]){\n      this.native.info(data);\n      if(this.walletInfo[\"Type\"] === \"Standard\"){\n           this.sendTx(data[\"success\"]);\n      }else if(this.walletInfo[\"Type\"] === \"Multi-Sign\"){\n          this.walletManager.encodeTransactionToString(data[\"success\"],(raw)=>{\n                   if(raw[\"success\"]){\n                    this.native.hideLoading();\n                    this.native.Go(this.navCtrl,ScancodePage,{\"tx\":{\"chianId\":this.curChain,\"fee\":this.fee/Config.SELA, \"raw\":raw[\"success\"]}});\n                   }else{\n                    this.native.info(raw);\n                   }\n          });\n      }\n     }else{\n         this.native.info(data);\n     }\n  });\n }\n\n sendTx(rawTransaction){\n  this.native.info(rawTransaction);\n  this.walletManager.publishTransaction(this.masterId,this.curChain,rawTransaction,(data)=>{\n    if(data['success']){\n      this.native.hideLoading();\n      this.native.toast_trans('send-raw-transaction');\n    }else{\n      this.native.info(data);\n    }\n  });\n }\n\n readWallet(raws){\n  this.walletManager.encodeTransactionToString(raws,(raw)=>{\n    if(raw[\"success\"]){\n      this.native.hideLoading();\n      this.native.Go(this.navCtrl,ScancodePage,{\"tx\":{\"chianId\":this.curChain,\"fee\":this.fee/Config.SELA, \"raw\":raw[\"success\"]}});\n    }\n});\n}\n\ncheckParms(){\n\n  if(Util.isNull(this.info['nodepublickey'])){\n    this.native.toast_trans('please-node-PublicKey');\n    return false;\n }\n\n  if(Util.isNull(this.info['netaddress'])){\n    this.native.toast_trans('please-enter-node-iPAddress');\n    return false;\n  }\n\n  return true;\n}\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/supernodeelection/superpoint/updateproducer/updateproducer.ts"],"sourceRoot":""}